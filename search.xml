<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/2025/07/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>NPDä»‹ç»</title>
    <url>/2025/07/devops/npd/NPD%E4%BB%8B%E7%BB%8D/</url>
    <content><![CDATA[<h1 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1 ç®€ä»‹"></a>1 ç®€ä»‹</h1><p>å®˜æ–¹æ–‡æ¡£åº“åœ°å€ï¼š<a href="https://github.com/kubernetes/node-problem-detector">https://github.com/kubernetes/node-problem-detector</a></p>
<p>node-problem-detector æ—¨åœ¨ä½¿é›†ç¾¤ç®¡ç†å †æ ˆä¸­çš„ä¸Šæ¸¸å±‚èƒ½å¤Ÿçœ‹åˆ°å„ç§èŠ‚ç‚¹é—®é¢˜ã€‚</p>
<p>å®ƒæ˜¯ä¸€ä¸ªåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œçš„å®ˆæŠ¤è¿›ç¨‹ï¼Œæ£€æµ‹èŠ‚ç‚¹é—®é¢˜å¹¶å°†å…¶æŠ¥å‘Šç»™apiserverã€‚</p>
<p>node-problem-detector å¯ä»¥ä½œä¸º DaemonSet è¿è¡Œï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹è¿è¡Œã€‚</p>
<p>ç°åœ¨å®ƒä½œä¸º GKEé›†ç¾¤ä¸­é»˜è®¤å¯ç”¨çš„Kubernetes Addonè¿è¡Œã€‚å®ƒä¹Ÿä½œä¸ºAKS Linux Extensionçš„ä¸€éƒ¨åˆ†åœ¨ AKS ä¸­é»˜è®¤å¯ç”¨ã€‚</p>
<h2 id="1-2-èƒŒæ™¯"><a href="#1-2-èƒŒæ™¯" class="headerlink" title="1.2 èƒŒæ™¯"></a>1.2 èƒŒæ™¯</h2><p>å¤§é‡èŠ‚ç‚¹é—®é¢˜å¯èƒ½ä¼šå½±å“èŠ‚ç‚¹ä¸Šè¿è¡Œçš„ podï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>åŸºç¡€è®¾æ–½å®ˆæŠ¤è¿›ç¨‹é—®é¢˜ï¼šntp æœåŠ¡å…³é—­ï¼›</li>
<li>ç¡¬ä»¶é—®é¢˜ï¼šCPUã€å†…å­˜æˆ–ç£ç›˜æŸåï¼›</li>
<li>å†…æ ¸é—®é¢˜ï¼šå†…æ ¸æ­»é”ã€æ–‡ä»¶ç³»ç»ŸæŸåï¼›</li>
<li>å®¹å™¨è¿è¡Œæ—¶é—®é¢˜ï¼šè¿è¡Œæ—¶å®ˆæŠ¤è¿›ç¨‹æ— å“åº”ï¼›</li>
<li>â€¦</li>
</ul>
<p>ç›®å‰ï¼Œè¿™äº›é—®é¢˜å¯¹äºé›†ç¾¤ç®¡ç†å †æ ˆä¸­çš„ä¸Šæ¸¸å±‚æ˜¯ä¸å¯è§çš„ï¼Œå› æ­¤ Kubernetes å°†ç»§ç»­å°† pod è°ƒåº¦åˆ°åèŠ‚ç‚¹ã€‚<br>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥äº†è¿™ä¸ªæ–°çš„å®ˆæŠ¤è¿›ç¨‹node-problem-detectoræ¥ä»å„ç§å®ˆæŠ¤è¿›ç¨‹æ”¶é›†èŠ‚ç‚¹é—®é¢˜ï¼Œå¹¶å°†å®ƒä»¬æä¾›ç»™ä¸Šæ¸¸å±‚ã€‚ä¸€æ—¦ä¸Šæ¸¸å±‚èƒ½å¤Ÿçœ‹åˆ°è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¨è®º <a href="https://github.com/kubernetes/node-problem-detector?tab=readme-ov-file#remedy-systems">remedy systems</a>äº†ã€‚</p>
<h2 id="1-3-Problem-API"><a href="#1-3-Problem-API" class="headerlink" title="1.3 Problem API"></a>1.3 Problem API</h2><p>node-problem-detector ä½¿ç”¨Eventå¹¶å‘NodeConditionapiserver æŠ¥å‘Šé—®é¢˜ã€‚</p>
<ul>
<li>NodeConditionï¼šå¯¼è‡´èŠ‚ç‚¹æ— æ³•ç”¨äº pod çš„æ°¸ä¹…æ€§é—®é¢˜åº”æŠ¥å‘Šä¸ºNodeConditionã€‚</li>
<li>Eventï¼šå¯¹ pod å½±å“æœ‰é™ä½†å…·æœ‰å‚è€ƒæ„ä¹‰çš„ä¸´æ—¶é—®é¢˜åº”æŠ¥å‘Šä¸ºEventã€‚</li>
</ul>
<h2 id="1-4-Problem-Daemon"><a href="#1-4-Problem-Daemon" class="headerlink" title="1.4 Problem Daemon"></a>1.4 Problem Daemon</h2><p>é—®é¢˜å®ˆæŠ¤è¿›ç¨‹æ˜¯ node-problem-detector çš„ä¸€ä¸ªå­å®ˆæŠ¤è¿›ç¨‹ã€‚å®ƒç›‘è§†ç‰¹å®šç±»å‹çš„èŠ‚ç‚¹é—®é¢˜å¹¶å°†å…¶æŠ¥å‘Šç»™ node-problem-detectorã€‚<br>å®ˆæŠ¤è¿›ç¨‹å¯èƒ½æ˜¯ï¼š</p>
<ul>
<li>ä¸“ä¸º Kubernetes ä¸“ç”¨ç”¨ä¾‹è®¾è®¡çš„å¾®å‹å®ˆæŠ¤è¿›ç¨‹ã€‚</li>
<li>ä¸èŠ‚ç‚¹é—®é¢˜æ£€æµ‹å™¨é›†æˆçš„ç°æœ‰èŠ‚ç‚¹å¥åº·ç›‘æ§å®ˆæŠ¤è¿›ç¨‹ã€‚</li>
</ul>
<p>ç›®å‰ï¼Œé—®é¢˜å®ˆæŠ¤è¿›ç¨‹åœ¨ node-problem-detector äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ä»¥ goroutine çš„å½¢å¼è¿è¡Œã€‚</p>
<p>æœªæ¥ï¼Œæˆ‘ä»¬ä¼šå°† node-problem-detectorå’Œé—®é¢˜å®ˆæŠ¤è¿›ç¨‹åˆ†ç¦»åˆ°ä¸åŒçš„å®¹å™¨ä¸­ï¼Œå¹¶ä½¿ç”¨ pod è§„èŒƒå°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ã€‚</p>
<p>æ¯ç§ç±»å‹çš„é—®é¢˜å®ˆæŠ¤è¿›ç¨‹éƒ½å¯ä»¥é€šè¿‡è®¾ç½®ç›¸åº”çš„æ„å»ºæ ‡ç­¾åœ¨ç¼–è¯‘æ—¶ç¦ç”¨ã€‚</p>
<p>å¦‚æœåœ¨ç¼–è¯‘æ—¶ç¦ç”¨å®ƒä»¬ï¼Œåˆ™å®ƒä»¬çš„æ‰€æœ‰æ„å»ºä¾èµ–é¡¹ã€å…¨å±€å˜é‡å’Œåå°goroutine éƒ½å°†ä»ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‰”é™¤ã€‚</p>
<p>æ”¯æŒçš„å®ˆæŠ¤è¿›ç¨‹åˆ—è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th>é—®é¢˜å®ˆæŠ¤è¿›ç¨‹ç±»å‹</th>
<th>èŠ‚ç‚¹çŠ¶æ€</th>
<th>è§£é‡Š</th>
<th>é…ç½®</th>
<th>ç¦ç”¨æ„å»ºæ ‡ç­¾</th>
</tr>
</thead>
<tbody><tr>
<td><a href="https://github.com/kubernetes/node-problem-detector/tree/master/pkg/systemlogmonitor">SystemLogMonitor</a></td>
<td>KernelDeadlock ReadonlyFilesystem FrequentKubeletRestart FrequentDockerRestart FrequentContainerdRestart</td>
<td>ç³»ç»Ÿæ—¥å¿—ç›‘è§†å™¨ç›‘è§†ç³»ç»Ÿæ—¥å¿—å¹¶æ ¹æ®é¢„å®šä¹‰çš„è§„åˆ™æŠ¥å‘Šé—®é¢˜å’ŒæŒ‡æ ‡ã€‚</td>
<td><a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/kernel-monitor-filelog.json">filelog</a>, <a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/kernel-monitor.json">kmsg</a>, <a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/kernel-monitor-counter.json">kernel</a>, <a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/systemd-monitor-counter.json">abrt</a>, <a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/systemd-monitor-counter.json">systemd</a></td>
<td>disable_system_log_monitor</td>
</tr>
<tr>
<td><a href="https://github.com/kubernetes/node-problem-detector/tree/master/pkg/systemstatsmonitor">SystemStatsMonitor</a></td>
<td>None(Could be added in the future)</td>
<td>èŠ‚ç‚¹é—®é¢˜æ£€æµ‹å™¨çš„ç³»ç»Ÿç»Ÿè®¡ç›‘è§†å™¨ï¼Œç”¨äºæ”¶é›†å„ç§ä¸å¥åº·ç›¸å…³çš„ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ä½œä¸ºæŒ‡æ ‡ã€‚è¯·å‚é˜…<a href="https://docs.google.com/document/d/1SeaUz6kBavI283Dq8GBpoEUDrHA2a795xtw0OvjM568/edit">æ­¤å¤„</a>çš„ææ¡ˆã€‚</td>
<td><a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/system-stats-monitor.json">system-stats-monitor</a></td>
<td>disable_system_stats_monitor</td>
</tr>
<tr>
<td><a href="https://github.com/kubernetes/node-problem-detector/tree/master/pkg/custompluginmonitor">CustomPluginMonitor</a></td>
<td>On-demand(According to users configuration), existing example: NTPProblem</td>
<td>ä¸€ä¸ªè‡ªå®šä¹‰çš„ node-problem-detector æ’ä»¶ç›‘æ§å™¨ï¼Œç”¨äºè°ƒç”¨å’Œæ£€æŸ¥å„ç§èŠ‚ç‚¹é—®é¢˜ï¼Œå¹¶ä½¿ç”¨ç”¨æˆ·å®šä¹‰çš„æ£€æŸ¥è„šæœ¬ã€‚è¯·å‚é˜…<a href="https://docs.google.com/document/d/1jK_5YloSYtboj-DtfjmYKxfNnUxCAvohLnsH5aGCAYQ/edit#">æ­¤å¤„</a>çš„ææ¡ˆã€‚</td>
<td><a href="https://github.com/kubernetes/node-problem-detector/blob/4ad49bbd84b8ced45ac825eac01ec93d9235935e/config/custom-plugin-monitor.json">example</a></td>
<td>disable_custom_plugin_monitor</td>
</tr>
<tr>
<td><a href="https://github.com/kubernetes/node-problem-detector/tree/master/pkg/healthchecker">HealthChecker</a></td>
<td>KubeletUnhealthy ContainerRuntimeUnhealthy</td>
<td>èŠ‚ç‚¹é—®é¢˜æ£€æµ‹å™¨çš„å¥åº·æ£€æŸ¥å™¨ç”¨äºæ£€æŸ¥ kubelet å’Œå®¹å™¨è¿è¡Œæ—¶çš„å¥åº·çŠ¶å†µã€‚</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="1-5-Exporter"><a href="#1-5-Exporter" class="headerlink" title="1.5 Exporter"></a>1.5 Exporter</h2><p>exporter æ˜¯ node-problem-detector çš„ä¸€ä¸ªç»„ä»¶ã€‚</p>
<p>å®ƒå‘æŸäº›åç«¯æŠ¥å‘ŠèŠ‚ç‚¹é—®é¢˜ å’Œ&#x2F;æˆ– æŒ‡æ ‡ã€‚</p>
<p>å…¶ä¸­ä¸€äº›å¯ä»¥åœ¨ç¼–è¯‘æ—¶ä½¿ç”¨æ„å»ºæ ‡è®°ç¦ç”¨ã€‚æ”¯æŒçš„å¯¼å‡ºå™¨åˆ—è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th>Exporter</th>
<th>è§£é‡Š</th>
<th>ç¦ç”¨æ„å»ºæ ‡ç­¾</th>
</tr>
</thead>
<tbody><tr>
<td>Kubernetes exporter</td>
<td>Kubernetes å¯¼å‡ºå™¨å‘ Kubernetes API æœåŠ¡å™¨æŠ¥å‘ŠèŠ‚ç‚¹é—®é¢˜ï¼šä¸´æ—¶é—®é¢˜æŠ¥å‘Šä¸ºäº‹ä»¶ï¼Œæ°¸ä¹…é—®é¢˜æŠ¥å‘Šä¸ºèŠ‚ç‚¹çŠ¶å†µã€‚</td>
<td></td>
</tr>
<tr>
<td>Prometheus exporter</td>
<td>Prometheus å¯¼å‡ºå™¨å°†èŠ‚ç‚¹é—®é¢˜å’ŒæŒ‡æ ‡æœ¬åœ°æŠ¥å‘Šä¸º Prometheus æŒ‡æ ‡</td>
<td></td>
</tr>
<tr>
<td><a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/exporter/stackdriver-exporter.json">Stackdriver exporter</a></td>
<td>Stackdriver å¯¼å‡ºå™¨å‘ Stackdriver Monitoring API æŠ¥å‘ŠèŠ‚ç‚¹é—®é¢˜å’ŒæŒ‡æ ‡ã€‚</td>
<td>disable_stackdriver_exporter</td>
</tr>
</tbody></table>
<h2 id="1-6-ç”¨æ³•"><a href="#1-6-ç”¨æ³•" class="headerlink" title="1.6 ç”¨æ³•"></a>1.6 ç”¨æ³•</h2><h3 id="1-6-1-æ ‡å¿—"><a href="#1-6-1-æ ‡å¿—" class="headerlink" title="1.6.1 æ ‡å¿—"></a>1.6.1 æ ‡å¿—</h3><ul>
<li>â€“versionï¼šæ‰“å°èŠ‚ç‚¹é—®é¢˜æ£€æµ‹å™¨çš„å½“å‰ç‰ˆæœ¬ã€‚</li>
<li>â€“hostname-overrideï¼šnode-problem-detector ç”¨äºæ›´æ–°çŠ¶æ€å’Œå‘å‡ºäº‹ä»¶çš„è‡ªå®šä¹‰èŠ‚ç‚¹åç§°ã€‚node-problem-detector é¦–å…ˆä»hostname-overrideè·å–èŠ‚ç‚¹åç§°ï¼Œç„¶åä»NODE_NAMEç¯å¢ƒå˜é‡ è·å–ï¼Œæœ€åè¿”å›åˆ°os.Hostnameã€‚</li>
</ul>
<h3 id="1-6-2-å¯¹äºç³»ç»Ÿæ—¥å¿—ç›‘æ§"><a href="#1-6-2-å¯¹äºç³»ç»Ÿæ—¥å¿—ç›‘æ§" class="headerlink" title="1.6.2 å¯¹äºç³»ç»Ÿæ—¥å¿—ç›‘æ§"></a>1.6.2 å¯¹äºç³»ç»Ÿæ—¥å¿—ç›‘æ§</h3><ul>
<li>â€“config.system-log-monitorï¼šç³»ç»Ÿæ—¥å¿—ç›‘è§†å™¨é…ç½®æ–‡ä»¶è·¯å¾„åˆ—è¡¨ï¼Œä»¥é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ config&#x2F;kernel-monitor.jsonã€‚èŠ‚ç‚¹é—®é¢˜æ£€æµ‹å™¨å°†ä¸ºæ¯ä¸ªé…ç½®å¯åŠ¨å•ç‹¬çš„æ—¥å¿—ç›‘è§†å™¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ—¥å¿—ç›‘è§†å™¨æ¥ç›‘è§†ä¸åŒçš„ç³»ç»Ÿæ—¥å¿—ã€‚</li>
</ul>
<h3 id="1-6-3-å¯¹äºç³»ç»Ÿç»Ÿè®¡ç›‘æ§"><a href="#1-6-3-å¯¹äºç³»ç»Ÿç»Ÿè®¡ç›‘æ§" class="headerlink" title="1.6.3 å¯¹äºç³»ç»Ÿç»Ÿè®¡ç›‘æ§"></a>1.6.3 å¯¹äºç³»ç»Ÿç»Ÿè®¡ç›‘æ§</h3><ul>
<li>â€“config.system-stats-monitorï¼šç³»ç»Ÿç»Ÿè®¡ç›‘æ§é…ç½®æ–‡ä»¶çš„è·¯å¾„åˆ—è¡¨ï¼Œä»¥é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ <a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/system-stats-monitor.json">config&#x2F;system-stats-monitor.json</a>ã€‚èŠ‚ç‚¹é—®é¢˜æ£€æµ‹å™¨å°†ä¸ºæ¯ä¸ªé…ç½®å¯åŠ¨ä¸€ä¸ªå•ç‹¬çš„ç³»ç»Ÿç»Ÿè®¡ç›‘æ§å™¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç³»ç»Ÿç»Ÿè®¡ç›‘æ§å™¨æ¥ç›‘æ§ä¸é—®é¢˜ç›¸å…³çš„ä¸åŒç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯ã€‚</li>
</ul>
<h3 id="1-6-4-å¯¹äºè‡ªå®šä¹‰æ’ä»¶ç›‘è§†å™¨"><a href="#1-6-4-å¯¹äºè‡ªå®šä¹‰æ’ä»¶ç›‘è§†å™¨" class="headerlink" title="1.6.4 å¯¹äºè‡ªå®šä¹‰æ’ä»¶ç›‘è§†å™¨"></a>1.6.4 å¯¹äºè‡ªå®šä¹‰æ’ä»¶ç›‘è§†å™¨</h3><ul>
<li>â€“config.custom-plugin-monitorï¼šè‡ªå®šä¹‰æ’ä»¶ç›‘æ§é…ç½®æ–‡ä»¶è·¯å¾„åˆ—è¡¨ï¼Œä»¥é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ <a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/custom-plugin-monitor.json">config&#x2F;custom-plugin-monitor.json</a>ã€‚èŠ‚ç‚¹é—®é¢˜æ£€æµ‹å™¨å°†ä¸ºæ¯ä¸ªé…ç½®å¯åŠ¨ä¸€ä¸ªå•ç‹¬çš„è‡ªå®šä¹‰æ’ä»¶ç›‘æ§ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸åŒçš„è‡ªå®šä¹‰æ’ä»¶ç›‘æ§æ¥ç›‘æ§ä¸åŒçš„èŠ‚ç‚¹é—®é¢˜ã€‚</li>
</ul>
<h3 id="1-6-5-å¯¹äºå¥åº·æ£€æŸ¥è€…"><a href="#1-6-5-å¯¹äºå¥åº·æ£€æŸ¥è€…" class="headerlink" title="1.6.5 å¯¹äºå¥åº·æ£€æŸ¥è€…"></a>1.6.5 å¯¹äºå¥åº·æ£€æŸ¥è€…</h3><ul>
<li>â€“enable-k8s-exporterï¼šå¯ç”¨å‘ Kubernetes API æœåŠ¡å™¨æŠ¥å‘Šï¼Œé»˜è®¤ä¸ºtrueã€‚</li>
<li>â€“apiserver-overrideï¼šç”¨äºè‡ªå®šä¹‰ node-problem-detector å¦‚ä½•è¿æ¥ apiserver çš„ URI å‚æ•°ã€‚å¦‚æœâ€“enable-k8s-exporteræ˜¯ï¼Œåˆ™å¿½ç•¥æ­¤å‚æ•°ã€‚æ ¼å¼ä¸<a href="https://github.com/kubernetes/heapster">Heapster</a> çš„æ ‡å¿—falseç›¸åŒã€‚ä¾‹å¦‚ï¼Œè¦æ— éœ€èº«ä»½éªŒè¯å³å¯è¿è¡Œï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é…ç½®ï¼š <a href="https://github.com/kubernetes/heapster/blob/master/docs/source-configuration.md#kubernetes">source</a></li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">http://APISERVER_IP:APISERVER_PORT?inClusterConfig=false</span><br></pre></td></tr></table></figure>

<p>è¯·å‚é˜…<a href="https://github.com/kubernetes/heapster/blob/master/docs/source-configuration.md#kubernetes">heapster æ–‡æ¡£</a><br>ä»¥è·å–å¯ç”¨é€‰é¡¹çš„å®Œæ•´åˆ—è¡¨ã€‚</p>
<ul>
<li>â€“addressï¼šç»‘å®šèŠ‚ç‚¹é—®é¢˜æ£€æµ‹æœåŠ¡å™¨çš„åœ°å€ã€‚</li>
<li>â€“portï¼šç»‘å®šèŠ‚ç‚¹é—®é¢˜æ£€æµ‹æœåŠ¡å™¨çš„ç«¯å£ã€‚ä½¿ç”¨ 0 è¡¨ç¤ºç¦ç”¨ã€‚</li>
</ul>
<h3 id="1-6-6-å¯¹äº-Prometheus-exporter"><a href="#1-6-6-å¯¹äº-Prometheus-exporter" class="headerlink" title="1.6.6 å¯¹äº Prometheus exporter"></a>1.6.6 å¯¹äº Prometheus exporter</h3><ul>
<li>â€“prometheus-addressï¼šç»‘å®šPrometheusæŠ“å–ç«¯ç‚¹çš„åœ°å€ï¼Œé»˜è®¤ä¸º127.0.0.1ã€‚</li>
<li>â€“prometheus-portï¼šç»‘å®š Prometheus æŠ“å–ç«¯ç‚¹çš„ç«¯å£ï¼Œé»˜è®¤ä¸º 20257ã€‚ä½¿ç”¨ 0 è¡¨ç¤ºç¦ç”¨ã€‚</li>
</ul>
<h3 id="1-6-7-å¯¹äº-Stackdriver-exporter"><a href="#1-6-7-å¯¹äº-Stackdriver-exporter" class="headerlink" title="1.6.7 å¯¹äº Stackdriver exporter"></a>1.6.7 å¯¹äº Stackdriver exporter</h3><ul>
<li>â€“exporter.stackdriverï¼šStackdriver å¯¼å‡ºå™¨é…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼Œä¾‹å¦‚config&#x2F;exporter&#x2F;stackdriver-exporter.jsonï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ã€‚è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²å³å¯ç¦ç”¨ã€‚</li>
</ul>
<h3 id="1-6-8-å·²å¼ƒç”¨çš„æ ‡å¿—"><a href="#1-6-8-å·²å¼ƒç”¨çš„æ ‡å¿—" class="headerlink" title="1.6.8 å·²å¼ƒç”¨çš„æ ‡å¿—"></a>1.6.8 å·²å¼ƒç”¨çš„æ ‡å¿—</h3><ul>
<li>â€“system-log-monitorsï¼šç³»ç»Ÿæ—¥å¿—ç›‘æ§é…ç½®æ–‡ä»¶çš„è·¯å¾„åˆ—è¡¨ï¼Œä»¥é€—å·åˆ†éš”ã€‚æ­¤é€‰é¡¹å·²å¼ƒç”¨ï¼Œç”±â€“config.system-log-monitoræ›¿ä»£ï¼Œå¹¶å°†è¢«åˆ é™¤ã€‚å¦‚æœåŒæ—¶è®¾ç½®â€“system-log-monitorså’Œ â€“config.system-log-monitor ï¼Œ NPD å°†å´©æºƒã€‚</li>
<li>â€“custom-plugin-monitorsï¼šè‡ªå®šä¹‰æ’ä»¶ç›‘æ§é…ç½®æ–‡ä»¶çš„è·¯å¾„åˆ—è¡¨ï¼Œä»¥é€—å·åˆ†éš”ã€‚æ­¤é€‰é¡¹å·²å¼ƒç”¨ï¼Œç”±â€“config.custom-plugin-monitoræ›¿ä»£ï¼Œå¹¶å°†è¢«åˆ é™¤ã€‚å¦‚æœåŒæ—¶è®¾ç½®â€“custom-plugin-monitorså’Œ â€“config.custom-plugin-monitorï¼ŒNPD å°†å´©æºƒã€‚</li>
</ul>
<h2 id="1-7-æ„å»ºé•œåƒ"><a href="#1-7-æ„å»ºé•œåƒ" class="headerlink" title="1.7 æ„å»ºé•œåƒ"></a>1.7 æ„å»ºé•œåƒ</h2><ul>
<li>å®‰è£…libsystemdARM GCC å·¥å…·é“¾çš„å¼€å‘ä¾èµ–é¡¹<ul>
<li>Debian &#x2F; Ubuntuï¼šapt install libsystemd-dev gcc-aarch64-linux-gnu</li>
</ul>
</li>
<li>git clone <a href="mailto:&#103;&#105;&#x74;&#x40;&#x67;&#105;&#x74;&#104;&#117;&#x62;&#x2e;&#x63;&#x6f;&#109;">&#103;&#105;&#x74;&#x40;&#x67;&#105;&#x74;&#104;&#117;&#x62;&#x2e;&#x63;&#x6f;&#109;</a>:kubernetes&#x2F;node-problem-detector.git</li>
<li>åœ¨é¡¶å±‚ç›®å½•ä¸­è¿è¡Œmakeã€‚å®ƒå°†ï¼š<ul>
<li>æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</li>
<li>æ„å»ºdockeré•œåƒã€‚äºŒè¿›åˆ¶æ–‡ä»¶å’Œconfig&#x2F;è¢«å¤åˆ¶åˆ°dockeré•œåƒä¸­ã€‚</li>
</ul>
</li>
</ul>
<p>å¦‚æœæ‚¨ä¸éœ€è¦æŸäº›ç±»åˆ«çš„é—®é¢˜å®ˆæŠ¤è¿›ç¨‹ï¼Œæ‚¨å¯ä»¥é€‰æ‹©åœ¨ç¼–è¯‘æ—¶ç¦ç”¨å®ƒä»¬ã€‚è¿™æ˜¯ä¿æŒ node-problem-detectorè¿è¡Œæ—¶ç´§å‡‘ä¸”æ²¡æœ‰ä¸å¿…è¦ä»£ç ï¼ˆä¾‹å¦‚å…¨å±€å˜é‡ã€goroutines ç­‰ï¼‰çš„æœ€ä½³æ–¹æ³•ã€‚</p>
<p>æ‚¨å¯ä»¥é€šè¿‡BUILD_TAGSåœ¨è¿è¡Œä¹‹å‰è®¾ç½®ç¯å¢ƒå˜é‡æ¥å®ç°è¿™ä¸€ç‚¹makeã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">BUILD_TAGS=&quot;disable_custom_plugin_monitor disable_system_stats_monitor&quot; make</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°å‘½ä»¤å°†åœ¨ä¸ä½¿ç”¨<a href="https://github.com/kubernetes/node-problem-detector/tree/master/pkg/custompluginmonitor">è‡ªå®šä¹‰æ’ä»¶ç›‘è§†å™¨</a>å’Œ<a href="https://github.com/kubernetes/node-problem-detector/tree/master/pkg/systemstatsmonitor">ç³»ç»Ÿç»Ÿè®¡ç›‘è§†å™¨</a>çš„æƒ…å†µä¸‹ç¼–è¯‘node-problem-detector ã€‚æŸ¥çœ‹<a href="https://github.com/kubernetes/node-problem-detector#problem-daemon">é—®é¢˜å®ˆæŠ¤è¿›ç¨‹</a>éƒ¨åˆ†ï¼Œäº†è§£å¦‚ä½•åœ¨ç¼–è¯‘æ—¶ç¦ç”¨æ¯ä¸ªé—®é¢˜å®ˆæŠ¤è¿›ç¨‹ã€‚</p>
<h2 id="1-8-æ¨é€é•œåƒ"><a href="#1-8-æ¨é€é•œåƒ" class="headerlink" title="1.8 æ¨é€é•œåƒ"></a>1.8 æ¨é€é•œåƒ</h2><p><code>make push</code>å°† docker é•œåƒä¸Šä¼ åˆ°æ³¨å†Œè¡¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé•œåƒå°†ä¸Šä¼ åˆ° <code>staging-k8s.gcr.io</code>ã€‚å¯ä»¥è½»æ¾ä¿®æ”¹<code>Makefile</code>ä»¥å°†é•œåƒæ¨é€åˆ°å¦ä¸€ä¸ªæ³¨å†Œè¡¨ã€‚</p>
<h2 id="1-9-å®‰è£…"><a href="#1-9-å®‰è£…" class="headerlink" title="1.9 å®‰è£…"></a>1.9 å®‰è£…</h2><p>å°† node-problem-detector<br>å®‰è£…åˆ°é›†ç¾¤ä¸­çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨<a href="https://github.com/deliveryhero/helm-charts/tree/master/stable/node-problem-detector">Helm å›¾è¡¨</a>ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">helm repo add deliveryhero https://charts.deliveryhero.io/</span><br><span class="line">helm install --generate-name deliveryhero/node-problem-detector</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ï¼Œæ‰‹åŠ¨å®‰è£… node-problem-detectorï¼š</p>
<p>ç¼–è¾‘<a href="https://github.com/kubernetes/node-problem-detector/blob/master/deployment/node-problem-detector.yaml">node-problem-detector.yaml</a>ä»¥é€‚åº”æ‚¨çš„ç¯å¢ƒã€‚å°†<code>log</code>å·è®¾ç½®ä¸ºæ‚¨çš„ç³»ç»Ÿæ—¥å¿—ç›®å½•ï¼ˆç”± SystemLogMonitor ä½¿ç”¨ï¼‰ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ ConfigMap è¦†ç›–<code>config</code> pod å†…çš„ç›®å½•ã€‚</p>
<p>ç¼–è¾‘<a href="https://github.com/kubernetes/node-problem-detector/blob/master/deployment/node-problem-detector-config.yaml">node-problem-detector-config.yaml</a>æ¥é…ç½® node-problem-detectorã€‚</p>
<ul>
<li>ç¼–è¾‘<a href="https://github.com/kubernetes/node-problem-detector/blob/master/deployment/rbac.yaml">rbac.yaml</a>ä»¥é€‚åˆæ‚¨çš„ç¯å¢ƒã€‚</li>
<li>ä½¿ç”¨ åˆ›å»º ServiceAccount å’Œ ClusterRoleBinding <code>kubectl create -f rbac.yaml</code>ã€‚</li>
<li>ä½¿ç”¨ åˆ›å»º ConfigMap <code>kubectl create -f node-problem-detector-config.yaml</code>ã€‚</li>
<li>ä½¿ç”¨ åˆ›å»º DaemonSet <code>kubectl create -f node-problem-detector.yaml</code>ã€‚</li>
</ul>
<h2 id="1-10-å¼€å§‹ç‹¬ç«‹è¿è¡Œ"><a href="#1-10-å¼€å§‹ç‹¬ç«‹è¿è¡Œ" class="headerlink" title="1.10 å¼€å§‹ç‹¬ç«‹è¿è¡Œ"></a>1.10 å¼€å§‹ç‹¬ç«‹è¿è¡Œ</h2><p>è¦ç‹¬ç«‹è¿è¡Œ node-problem-detectorï¼Œæ‚¨åº”è¯¥è®¾ç½®inClusterConfigä¸ºfalseï¼Œå¹¶ä¸”æ•™ node-problem-detector å¦‚ä½• è®¿é—® apiserverï¼Œä¹Ÿå°±æ˜¯apiserver-overrideã€‚</p>
<p>è¦ä½¿ç”¨ä¸å®‰å…¨çš„ apiserver è¿æ¥ç‹¬ç«‹è¿è¡Œ node-problem-detectorï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">node-problem-detector --apiserver-override=http://APISERVER_IP:APISERVER_INSECURE_PORT?inClusterConfig=false</span><br></pre></td></tr></table></figure>

<p>æ›´å¤šåœºæ™¯è¯·è§<a href="https://github.com/kubernetes/heapster/blob/master/docs/source-configuration.md#kubernetes">æ­¤å¤„</a></p>
<h2 id="1-11-è¯•ç”¨"><a href="#1-11-è¯•ç”¨" class="headerlink" title="1.11 è¯•ç”¨"></a>1.11 è¯•ç”¨</h2><p>æ‚¨å¯ä»¥åœ¨æ­£åœ¨è¿è¡Œçš„é›†ç¾¤ä¸­å°è¯•ä½¿ç”¨ node-problem-detectorï¼Œæ–¹æ³•æ˜¯å°†æ¶ˆæ¯æ³¨å…¥åˆ° node-problem-detector æ­£åœ¨ç›‘è§†çš„æ—¥å¿—ä¸­ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ node-problem-detector æ­£åœ¨ä½¿ç”¨KernelMonitorã€‚</p>
<p>åœ¨æ‚¨çš„æœºå™¨ä¸Šè¿è¡Œ<code>kubectl get events -w</code>ã€‚åœ¨èŠ‚ç‚¹ä¸Šè¿è¡Œ<code>sudo sh -c &quot;echo &#39;kernel: BUG: unable to handle kernel NULL pointer dereference at TESTING&#39; &gt;&gt; /dev/kmsg&quot;</code>ã€‚ç„¶åæ‚¨åº”è¯¥ä¼šçœ‹åˆ°è¯¥KernelOopssäº‹ä»¶ã€‚</p>
<p>æ·»åŠ æ–°è§„åˆ™æˆ–å¼€å‘èŠ‚ç‚¹é—®é¢˜æ£€æµ‹å™¨æ—¶ï¼Œåœ¨ç‹¬ç«‹æ¨¡å¼ä¸‹åœ¨æœ¬åœ°å·¥ä½œç«™ä¸Šè¿›è¡Œæµ‹è¯•å¯èƒ½æ›´å®¹æ˜“ã€‚</p>
<p>å¯¹äº API æœåŠ¡å™¨ï¼Œä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨kubectl proxyæ­£åœ¨è¿è¡Œçš„é›†ç¾¤çš„ API æœåŠ¡å™¨åœ¨æœ¬åœ°å¯ç”¨ã€‚</p>
<p>æ‚¨ä¼šæ”¶åˆ°ä¸€äº›é”™è¯¯ï¼Œå› ä¸º API æœåŠ¡å™¨æ— æ³•è¯†åˆ«æ‚¨çš„æœ¬åœ°å·¥ä½œç«™ã€‚ä½†æ— è®ºå¦‚ä½•ï¼Œæ‚¨ä»ç„¶åº”è¯¥èƒ½å¤Ÿæµ‹è¯•æ‚¨çš„æ–°è§„åˆ™ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæµ‹è¯•KernelMonitorè§„åˆ™ï¼š</p>
<ul>
<li><code>make</code>ï¼ˆæœ¬åœ°æ„å»ºnode-problem-detectorï¼‰</li>
<li><code>kubectl proxy --port=8080</code>ï¼ˆä½¿æ­£åœ¨è¿è¡Œçš„é›†ç¾¤çš„ API æœåŠ¡å™¨åœ¨æœ¬åœ°å¯ç”¨ï¼‰</li>
<li>å°†KernelMonitoræ›´æ–°åˆ°æ‚¨çš„æœ¬åœ°å†…æ ¸æ—¥å¿—ç›®å½•<code>logPath</code>ã€‚ä¾‹å¦‚ï¼Œåœ¨æŸäº› Linux ç³»ç»Ÿä¸Šï¼Œå®ƒæ˜¯<code>/run/log/journal</code>, è€Œä¸æ˜¯<code>/var/log/journal</code>ã€‚</li>
<li><code>./bin/node-problem-detector --logtostderr --apiserver-override=http://127.0.0.1:8080?inClusterConfig=false --config.system-log-monitor=config/kernel-monitor.json --config.system-stats-monitor=config/system-stats-monitor.json --port=20256 --prometheus-port=2025</code>ï¼ˆæˆ–æŒ‡å‘ä»»ä½• API æœåŠ¡å™¨åœ°å€ï¼šç«¯å£å’Œ Prometheus ç«¯å£ï¼‰</li>
<li><code>sudo sh -c &quot;echo &#39;kernel: BUG: unable to handle kernel NULL pointer dereference at TESTING&#39; &gt;&gt; /dev/kmsg&quot;</code></li>
<li>æ‚¨å¯ä»¥<code>KernelOops</code>åœ¨èŠ‚ç‚¹é—®é¢˜æ£€æµ‹å™¨æ—¥å¿—ä¸­çœ‹åˆ°äº‹ä»¶ã€‚</li>
<li><code>sudo sh -c &quot;echo &#39;kernel: INFO: task docker:20744 blocked for more than 120 seconds.&#39; &gt;&gt; /dev/kmsg&quot;</code></li>
<li>æ‚¨å¯ä»¥åœ¨node-problem-detector logçœ‹DockerHung eventå’ŒçŠ¶æ€</li>
<li>æ‚¨å¯ä»¥åœ¨<a href="http://127.0.0.1:20256/conditions%E6%9F%A5%E7%9C%8B%60DockerHung%60%E7%8A%B6%E6%80%81">http://127.0.0.1:20256/conditionsæŸ¥çœ‹DockerHungçŠ¶æ€</a></li>
<li>æ‚¨å¯ä»¥åœ¨<a href="http://127.0.0.1:20257/metrics%E4%B8%8A%E6%9F%A5%E7%9C%8B">http://127.0.0.1:20257/metrics</a>ä¸ŠæŸ¥çœ‹ Prometheus æ ¼å¼çš„ç£ç›˜ç›¸å…³ç³»ç»ŸæŒ‡æ ‡ã€‚</li>
</ul>
<p>æ³¨ï¼š æ‚¨å¯ä»¥åœ¨<a href="https://github.com/kubernetes/node-problem-detector/tree/master/test/kernel_log_generator/problems">test&#x2F;kernel_log_generator&#x2F;problems</a>ä¸‹æŸ¥çœ‹æ›´å¤šè§„åˆ™ç¤ºä¾‹ã€‚</p>
<ul>
<li>å¯¹äº<a href="https://github.com/kubernetes/node-problem-detector/blob/master/config/kernel-monitor.json">KernelMonitor</a><br>æ¶ˆæ¯æ³¨å…¥ï¼Œæ‰€æœ‰æ¶ˆæ¯éƒ½åº”è¯¥æœ‰kernel: å‰ç¼€ï¼ˆå¦è¯·æ³¨æ„ï¼Œåé¢æœ‰ä¸€ä¸ªç©ºæ ¼:ï¼‰ï¼›æˆ–è€…ä½¿ç”¨<a href="https://github.com/kubernetes/node-problem-detector/blob/master/test/kernel_log_generator/generator.sh">generator.sh</a>ã€‚</li>
<li>è¦å°†å…¶ä»–æ—¥å¿—ï¼ˆå¦‚ systemd æ—¥å¿—ï¼‰æ³¨å…¥ journaldï¼Œè¯·ä½¿ç”¨<code>echo &#39;Some systemd message&#39; | systemd-cat -t systemd</code>ã€‚</li>
</ul>
<h2 id="1-12-Remedy-Systems"><a href="#1-12-Remedy-Systems" class="headerlink" title="1.12 Remedy Systems"></a>1.12 Remedy Systems</h2><p>Remedy Systemsæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæ—¨åœ¨å°è¯•è§£å†³node-problem-detectoræ£€æµ‹åˆ°çš„é—®é¢˜çš„è¿‡ç¨‹ã€‚</p>
<p>Remedy Systemsä¼šè§‚å¯Ÿnode-problem-detectorå‘å‡ºçš„äº‹ä»¶ å’Œ&#x2F;æˆ– èŠ‚ç‚¹çŠ¶å†µï¼Œå¹¶é‡‡å–æªæ–½ä½¿ Kubernetes é›†ç¾¤æ¢å¤å¥åº·çŠ¶æ€ã€‚</p>
<p>è¡¥æ•‘ç³»ç»Ÿæœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li><a href="https://github.com/planetlabs/draino">Draino</a> æ ¹æ®æ ‡ç­¾å’ŒèŠ‚ç‚¹æ¡ä»¶è‡ªåŠ¨æ’ç©º KubernetesèŠ‚ç‚¹ã€‚ä¸æ‰€æœ‰æä¾›çš„æ ‡ç­¾å’Œä»»ä½•æä¾›çš„èŠ‚ç‚¹æ¡ä»¶åŒ¹é…çš„èŠ‚ç‚¹å°†è¢«é˜»æ­¢ç«‹å³æ¥å—æ–° podï¼ˆä¹Ÿç§°ä¸ºâ€œå°é”â€ï¼‰ï¼Œå¹¶åœ¨å¯é…ç½®çš„æ—¶é—´å<a href="https://kubernetes.io/docs/tasks/administer-cluster/safely-drain-node/">æ’ç©º</a>ã€‚Drainoå¯ä»¥ä¸ <a href="https://github.com/kubernetes/autoscaler/tree/master/cluster-autoscaler">Cluster Autoscaler</a>ç»“åˆä½¿ç”¨ï¼Œä»¥è‡ªåŠ¨ç»ˆæ­¢æ’ç©ºçš„èŠ‚ç‚¹ã€‚è¯·å‚é˜… <a href="https://github.com/kubernetes/node-problem-detector/issues/199">æ­¤é—®é¢˜</a> ï¼Œäº†è§£ Drainoçš„ç¤ºä¾‹ç”Ÿäº§ç”¨ä¾‹ã€‚</li>
<li><a href="https://github.com/kubernetes-sigs/descheduler">Descheduler</a> å–æ¶ˆè°ƒåº¦ç­–ç•¥RemovePodsViolatingNodeTaintsä¼šé©±é€èŠ‚ç‚¹ä¸Šè¿åNoScheduleæ±¡æŸ“çš„Podã€‚å¿…é¡»å¯ç”¨k8sè°ƒåº¦ç¨‹åºçš„TaintNodesByConditionåŠŸèƒ½ã€‚</li>
<li><a href="https://github.com/kubernetes/autoscaler/tree/master/cluster-autoscaler">Cluster Autoscaler</a> å¯ç”¨äºè‡ªåŠ¨ç»ˆæ­¢è€—å°½çš„èŠ‚ç‚¹ã€‚</li>
<li><a href="https://github.com/medik8s">mediK8S</a> æ˜¯ä¸€ä¸ªåŸºäº<a href="https://github.com/medik8s/node-healthcheck-operator">Node Health Check Operator (NHC)</a>æ„å»ºçš„è‡ªåŠ¨ä¿®å¤ç³»ç»Ÿçš„æ€»ä½“é¡¹ç›®ï¼Œè¯¥ç³»ç»Ÿç›‘æ§èŠ‚ç‚¹çŠ¶å†µå¹¶ä½¿ç”¨ä¿®å¤ APIå°†ä¿®å¤å§”æ‰˜ç»™å¤–éƒ¨ä¿®å¤ç¨‹åºã€‚</li>
<li><a href="https://github.com/medik8s/poison-pill">Poison-Pill</a>æ˜¯ä¸€ä¸ªä¿®å¤ç¨‹åºï¼Œå®ƒå°†é‡æ–°å¯åŠ¨èŠ‚ç‚¹å¹¶ç¡®ä¿æ‰€æœ‰æœ‰çŠ¶æ€çš„å·¥ä½œè´Ÿè½½éƒ½å¾—åˆ°é‡æ–°å®‰æ’ã€‚å¦‚æœé›†ç¾¤å…·æœ‰è¶³å¤Ÿçš„å¥åº·å®¹é‡ï¼ŒNHCæ”¯æŒæœ‰æ¡ä»¶åœ°è¿›è¡Œä¿®å¤ï¼Œæˆ–è€…æ‰‹åŠ¨æš‚åœä»»ä½•æ“ä½œä»¥æœ€å¤§é™åº¦åœ°å‡å°‘é›†ç¾¤ä¸­æ–­ã€‚</li>
<li><a href="https://cluster-api.sigs.k8s.io/">Cluster API</a> çš„<a href="https://cluster-api.sigs.k8s.io/developer/architecture/controllers/machine-health-check">MachineHealthCheck</a>è´Ÿè´£ä¿®å¤ä¸å¥åº·çš„æœºå™¨ã€‚</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>BKCI ç®€ä»‹</title>
    <url>/2025/07/devops/blueking/BKCI%E7%AE%80%E4%BB%8B/</url>
    <content><![CDATA[<h1 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h1><p>BK-CIå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/intro/README.md">https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/intro/README.md</a><br>githubä»“åº“åœ°å€ï¼š<a href="https://github.com/TencentBlueKing/bk-ci">https://github.com/TencentBlueKing/bk-ci</a></p>
<h1 id="å¯¼èˆª"><a href="#å¯¼èˆª" class="headerlink" title="å¯¼èˆª"></a>å¯¼èˆª</h1><table>
<thead>
<tr>
<th>ğŸ¤ äº†è§£åŸºæœ¬æ¦‚å¿µ</th>
<th>ğŸ‘‰ ä½¿ç”¨ BKCI</th>
<th>ğŸš€ éƒ¨ç½² BKCI</th>
</tr>
</thead>
<tbody><tr>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/intro/bkci.md">BKCI æ˜¯ä»€ä¹ˆï¼Ÿ</a></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Quickstarts/Create-your-first-pipeline.md">åˆ›å»ºä½ çš„ç¬¬ä¸€æ¡æµæ°´çº¿</a></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Setup/system-requirements/hardware.md">BKCI ç¡¬ä»¶è§„æ ¼æŒ‡å—</a></td>
</tr>
<tr>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/intro/terminology/components.md">BKCI ç»„ä»¶</a></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Quickstarts/Link-your-first-repo.md">å…³è”ä½ çš„ç¬¬ä¸€ä¸ªä»£ç åº“</a></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Setup/system-requirements/system.md">BKCI ç³»ç»Ÿè¦æ±‚</a></td>
</tr>
<tr>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/intro/terminology/Learn-pipeline-in-5min.md">å¿«é€Ÿç†Ÿæ‚‰æµæ°´çº¿</a></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Quickstarts/Enable-ci.md">ä¸ºä½ çš„Gitå·¥ç¨‹å¼€å¯CI</a></td>
<td></td>
</tr>
<tr>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/intro/terminology/Learn-pipeline-in-5min.md">æœ¯è¯­è§£é‡Š</a></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Quickstarts/Case/Examples/vars-usage.md">ç¤ºä¾‹</a></td>
<td></td>
</tr>
<tr>
<td></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/rest-api/read-before-use.md">APIæ¥å£</a></td>
<td></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>ğŸ“” äº§å“åŠŸèƒ½</th>
<th>ğŸª ç ”å‘å•†åº—</th>
</tr>
</thead>
<tbody><tr>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Services/Pipeline/pipeline-list.md">æµæ°´çº¿</a></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Services/Store/home.md">æµè§ˆç ”å‘å•†åº—</a></td>
</tr>
<tr>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Services/Console/Console.md">æ§åˆ¶å°</a></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Services/Store/start-new-task.md">å¼€å‘ä¸€ä¸ªæµæ°´çº¿æ’ä»¶</a></td>
</tr>
<tr>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Services/Ticket/ticket.md">å‡­è¯ç®¡ç†</a></td>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Services/Store/upload-new-task.md">åœ¨ BKCI é‡Œä½¿ç”¨å•†åº—æ’ä»¶</a></td>
</tr>
<tr>
<td><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Services/Pools/host-to-bkci.md">æ„å»ºèµ„æº</a></td>
<td></td>
</tr>
</tbody></table>
<h1 id="ç›¸å…³æ–‡æ¡£"><a href="#ç›¸å…³æ–‡æ¡£" class="headerlink" title="ç›¸å…³æ–‡æ¡£"></a>ç›¸å…³æ–‡æ¡£</h1><p>è“é²¸å­¦ä¹ ç¤¾åŒºï¼š<a href="https://bk.tencent.com/s-mart/communities">https://bk.tencent.com/s-mart/communities</a><br>è“é²¸å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://bk.tencent.com/docs/">https://bk.tencent.com/docs/</a></p>
<p><strong>è“é²¸ä½“ç³»</strong><br>è“é²¸ç®€ä»‹ï¼š<a href="https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/intro.md">https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/intro.md</a><br>æ ¸å¿ƒä¼˜åŠ¿ï¼š<a href="https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/advantages.md">https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/advantages.md</a><br>ä½“ç³»æ¶æ„ï¼š<a href="https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/Solution/solution.md">https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/Solution/solution.md</a><br>CIé¢†åŸŸï¼š<a href="https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/Solution/ci_intro.md">https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/Solution/ci_intro.md</a><br>CDé¢†åŸŸï¼š<a href="https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/Solution/cd_intro.md">https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/Solution/cd_intro.md</a><br>COé¢†åŸŸï¼š<a href="https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/Solution/co_intro.md">https://bk.tencent.com/docs/markdown/ZH/BlueKingFamily/7.2/UserGuide/Solution/co_intro.md</a></p>
]]></content>
  </entry>
  <entry>
    <title>BK-CIæ’ä»¶å¼€å‘æŒ‡å¼•</title>
    <url>/2025/07/devops/blueking/BK-CI%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%8C%87%E5%BC%95/</url>
    <content><![CDATA[<h1 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h1><blockquote>
<p>å¼€å‘æ’ä»¶å‰ï¼Œå…ˆè¿›å…¥æ’ä»¶å·¥ä½œå°åˆå§‹åŒ–ä¸€ä¸ªæ’ä»¶ï¼Œç¡®å®šæ’ä»¶åœ¨å¹³å°ä¸­çš„å”¯ä¸€æ ‡è¯†</p>
</blockquote>
<h1 id="å·¥ä½œå°"><a href="#å·¥ä½œå°" class="headerlink" title="å·¥ä½œå°"></a>å·¥ä½œå°</h1><p>å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œæ–°å¢&#x2F;å‘å¸ƒ&#x2F;ä¸‹æ¶ç­‰ç®¡ç†æ’ä»¶çš„æ“ä½œ</p>
<h2 id="åŠŸèƒ½åŒºä»‹ç»"><a href="#åŠŸèƒ½åŒºä»‹ç»" class="headerlink" title="åŠŸèƒ½åŒºä»‹ç»"></a>åŠŸèƒ½åŒºä»‹ç»</h2><p><img src="/img.png" alt="img.png"></p>
<ol>
<li>åˆ‡æ¢èµ„æºç±»å‹</li>
<li>æ–°å¢æ’ä»¶</li>
<li>å•ä¸ªæ’ä»¶çš„ç®¡ç†å…¥å£</li>
<li>å‡çº§ã€ä¸‹æ¶ã€åˆ é™¤æ’ä»¶å¿«æ·å…¥å£</li>
<li>æŒ‡å¼•æ–‡æ¡£å’Œæ’ä»¶ UI è°ƒè¯•å·¥å…·å…¥å£</li>
</ol>
<h2 id="æ–°å¢æ’ä»¶"><a href="#æ–°å¢æ’ä»¶" class="headerlink" title="æ–°å¢æ’ä»¶"></a>æ–°å¢æ’ä»¶</h2><p><img src="/img_1.png" alt="img_1.png"></p>
<ol>
<li>æ ‡è¯†</li>
</ol>
<ul>
<li>æ’ä»¶åœ¨å¹³å°ä¸­çš„å”¯ä¸€æ ‡è¯†ï¼Œå»ºè®®å–å’Œæ’ä»¶åŠŸèƒ½ç›¸å…³çš„å¯è¯»æ€§å¥½çš„è‹±æ–‡æ ‡è¯†</li>
</ul>
<ol start="2">
<li>è°ƒè¯•é¡¹ç›®</li>
</ol>
<ul>
<li>æ’ä»¶å‘å¸ƒè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥åœ¨è°ƒè¯•é¡¹ç›®ä¸‹å°†æ’ä»¶æ·»åŠ åˆ°æµæ°´çº¿æ‰§è¡Œï¼Œå¯¹æ’ä»¶è¿›è¡Œæµ‹è¯•ï¼Œä¿è¯æ’ä»¶åŠŸèƒ½æ»¡è¶³é¢„æœŸã€‚</li>
<li>å»ºè®®æ–°å¢ä¸“ç”¨çš„æ’ä»¶è°ƒè¯•é¡¹ç›®ï¼Œé¿å…æµ‹è¯•è¿‡ç¨‹ä¸­å½±å“åˆ°ä¸šåŠ¡ã€‚</li>
</ul>
<ol start="3">
<li>å¼€å‘è¯­è¨€</li>
</ol>
<ul>
<li>æ”¯æŒå››ç§è¯­è¨€å¼€å‘æ’ä»¶ï¼š<ul>
<li>Javaï¼ˆæ¨èï¼‰</li>
<li>Python</li>
<li>Golang</li>
<li>Nodejs</li>
</ul>
</li>
</ul>
<h2 id="å¼€å‘æ’ä»¶"><a href="#å¼€å‘æ’ä»¶" class="headerlink" title="å¼€å‘æ’ä»¶"></a>å¼€å‘æ’ä»¶</h2><blockquote>
<p>åˆå§‹åŒ–å¥½æ’ä»¶ä¹‹åï¼Œå¯ä»¥å¼€å§‹å¼€å‘æ’ä»¶</p>
</blockquote>
<ul>
<li>æ ¹æ®å¼€å‘è¯­è¨€å‚è€ƒå¯¹åº”çš„å¼€å‘æŒ‡å¼•<ul>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-guide/java.md">Java æ’ä»¶å¼€å‘æŒ‡å¼•</a></li>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-guide/python.md">Python æ’ä»¶å¼€å‘æŒ‡å¼•</a></li>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-guide/golang.md">Golang æ’ä»¶å¼€å‘æŒ‡å¼•</a></li>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-guide/nodejs.md">Nodejs æ’ä»¶å¼€å‘æŒ‡å¼•</a></li>
</ul>
</li>
</ul>
<h2 id="æ’ä»¶ç§æœ‰é…ç½®"><a href="#æ’ä»¶ç§æœ‰é…ç½®" class="headerlink" title="æ’ä»¶ç§æœ‰é…ç½®"></a>æ’ä»¶ç§æœ‰é…ç½®</h2><blockquote>
<p>æ’ä»¶çº§åˆ«çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ tokenã€ç”¨æˆ·åå¯†ç ã€IPã€åŸŸåç­‰ï¼Œä¸å»ºè®®ç›´æ¥æäº¤åˆ°ä»£ç åº“ï¼Œé€šè¿‡å·¥ä½œå°ç§æœ‰é…ç½®ç•Œé¢ç®¡ç†</p>
</blockquote>
<p><img src="/img_2.png" alt="img_2.png"></p>
<h1 id="Golang-æ’ä»¶å¼€å‘"><a href="#Golang-æ’ä»¶å¼€å‘" class="headerlink" title="Golang æ’ä»¶å¼€å‘"></a>Golang æ’ä»¶å¼€å‘</h1><h2 id="æ’ä»¶å¼€å‘æ¡†æ¶è¯´æ˜"><a href="#æ’ä»¶å¼€å‘æ¡†æ¶è¯´æ˜" class="headerlink" title="æ’ä»¶å¼€å‘æ¡†æ¶è¯´æ˜"></a>æ’ä»¶å¼€å‘æ¡†æ¶è¯´æ˜</h2><blockquote>
<p>æ’ä»¶æœ€ç»ˆæ‰“åŒ…æˆä¸€ä¸ªå‘½ä»¤è¡Œå¯æ‰§è¡Œçš„å‘½ä»¤å³å¯ï¼Œå¯¹å¼€å‘æ¡†æ¶æ— ç¡¬æ€§è¦æ±‚ ä¸‹è¾¹ä»¥ demo æ’ä»¶ä¸ºä¾‹ç¤ºèŒƒ</p>
</blockquote>
<h2 id="ç¤ºä¾‹æ’ä»¶ä»£ç å·¥ç¨‹çš„æ•´ä½“ç»“æ„å¦‚ä¸‹"><a href="#ç¤ºä¾‹æ’ä»¶ä»£ç å·¥ç¨‹çš„æ•´ä½“ç»“æ„å¦‚ä¸‹" class="headerlink" title="ç¤ºä¾‹æ’ä»¶ä»£ç å·¥ç¨‹çš„æ•´ä½“ç»“æ„å¦‚ä¸‹"></a>ç¤ºä¾‹æ’ä»¶ä»£ç å·¥ç¨‹çš„æ•´ä½“ç»“æ„å¦‚ä¸‹</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">|- &lt;ä½ çš„æ’ä»¶æ ‡è¯†&gt;</span><br><span class="line">    |- cmd</span><br><span class="line">        |- application</span><br><span class="line">            |- main.go</span><br><span class="line"></span><br><span class="line">    |- hello</span><br><span class="line">        |- hello.go</span><br></pre></td></tr></table></figure>

<h2 id="å¦‚ä½•å¼€å‘æ’ä»¶ï¼š"><a href="#å¦‚ä½•å¼€å‘æ’ä»¶ï¼š" class="headerlink" title="å¦‚ä½•å¼€å‘æ’ä»¶ï¼š"></a>å¦‚ä½•å¼€å‘æ’ä»¶ï¼š</h2><blockquote>
<p>å‚è€ƒ <a href="https://github.com/ci-plugins/plugin-demo-golang">plugin-demo-golang</a></p>
</blockquote>
<ul>
<li>å»ºæ’ä»¶ä»£ç å·¥ç¨‹<ul>
<li>æ’ä»¶ä»£ç å»ºè®®ä¼ä¸šä¸‹ç»Ÿä¸€ç®¡ç†ã€‚ é€šç”¨çš„å¼€æºæ’ä»¶å¯ä»¥è”ç³»è“é²¸å®˜æ–¹æ”¾åˆ° <a href="https://github.com/TencentBlueKing">TencentBlueKing</a> ä¸‹ï¼Œä¾›æ›´å¤šç”¨æˆ·ä½¿ç”¨</li>
</ul>
</li>
<li>å®ç°æ’ä»¶åŠŸèƒ½</li>
<li>è§„èŒƒï¼š<ul>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-standard/plugin-specification.md">æ’ä»¶å¼€å‘è§„èŒƒ</a></li>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-standard/plugin-config.md">æ’ä»¶é…ç½®è§„èŒƒ</a></li>
</ul>
</li>
<li>æ’ä»¶å‰ç«¯ä¸ä»…å¯ä»¥é€šè¿‡ task.json è¿›è¡Œæ ‡å‡†åŒ–é…ç½®ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰å¼€å‘ï¼š<ul>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-standard/plugin-custom-ui.md">è‡ªå®šä¹‰æ’ä»¶ UI äº¤äº’æŒ‡å¼•</a></li>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-standard/plugin-output.md">æ’ä»¶è¾“å‡ºè§„èŒƒ</a></li>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-standard/plugin-error-code.md">æ’ä»¶é”™è¯¯ç è§„èŒƒ</a></li>
<li><a href="https://bk.tencent.com/docs/markdown/ZH/Devops/3.0/UserGuide/Developer/plugins/plugin-dev-standard/release.md">æ’ä»¶å‘å¸ƒåŒ…è§„èŒƒ</a></li>
</ul>
</li>
</ul>
<h2 id="Demoç¤ºä¾‹ç ”è¯»"><a href="#Demoç¤ºä¾‹ç ”è¯»" class="headerlink" title="Demoç¤ºä¾‹ç ”è¯»"></a>Demoç¤ºä¾‹ç ”è¯»</h2><p>å°† <a href="https://github.com/ci-plugins/plugin-demo-golang">plugin-demo-golang</a> cloneåˆ°æœ¬åœ°ã€‚<br>æ¥çœ‹ä¸‹é¡¹ç›®ç»“æ„ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ CONTRIBUTING.md</span><br><span class="line">â”œâ”€â”€ LICENSE</span><br><span class="line">â”œâ”€â”€ Makefile</span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â”œâ”€â”€ go.mod</span><br><span class="line">â”œâ”€â”€ go.sum</span><br><span class="line">â”œâ”€â”€ i18n</span><br><span class="line">â”‚   â”œâ”€â”€ message_en_US.properties</span><br><span class="line">â”‚   â””â”€â”€ message_zh_CN.properties</span><br><span class="line">â”œâ”€â”€ main.go</span><br><span class="line">â”œâ”€â”€ task.json</span><br><span class="line">â””â”€â”€ translation</span><br><span class="line">    â””â”€â”€ translation.go</span><br><span class="line"></span><br><span class="line">3 directories, 11 files</span><br></pre></td></tr></table></figure>

<p>å’¦ï¼å’Œä¸Šé¢è¯´çš„æ’ä»¶ä»£ç å·¥ç¨‹çš„æ•´ä½“æ¶æ„ä¸ä¸€æ ·ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">|- &lt;ä½ çš„æ’ä»¶æ ‡è¯†&gt;</span><br><span class="line">    |- cmd</span><br><span class="line">        |- application</span><br><span class="line">            |- main.go</span><br><span class="line"></span><br><span class="line">    |- hello</span><br><span class="line">        |- hello.go</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡ï¼Œè¿™ä¸é‡è¦ï¼Œåªè¦æ’ä»¶æœ€ç»ˆèƒ½å¤Ÿæ‰“åŒ…æˆä¸€ä¸ªå‘½ä»¤è¡Œå¯æ‰§è¡Œçš„å‘½ä»¤å³å¯ã€‚<br>è¿™é‡Œi18næ˜¯å®ç°ä¸­è‹±æ–‡å›½é™…åŒ–ä½¿ç”¨çš„ï¼Œ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">â”œâ”€â”€ i18n</span><br><span class="line">â”‚   â”œâ”€â”€ message_en_US.properties</span><br><span class="line">â”‚   â””â”€â”€ message_zh_CN.properties</span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸‹å†…å®¹å¯¹æ¯”ï¼š<br>message_en_US.propertiesï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">input.desc.label=desc</span><br><span class="line">100001=input param [&#123;0&#125;] invitated</span><br></pre></td></tr></table></figure>

<p>message_zh_CN.properties</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">input.desc.label=æè¿°</span><br><span class="line">100001=è¾“å…¥å‚æ•°[&#123;0&#125;]éæ³•</span><br></pre></td></tr></table></figure>

<p>é‚£æˆ‘ä»¬å°±å¯ä»¥çŒœæµ‹ï¼Œè¿™é‡Œæ˜¯å®ç°è¾“å…¥å‚æ•°[{0}]éæ³•è¿™å¥è¯çš„ä¸­è‹±æ–‡ï¼Œå…¶ä¸­[{0}]ä¼šä½¿ç”¨å…·ä½“çš„å‚æ•°å¡«å……ã€‚<br>ç„¶åi18ngeneratoråˆ™æ˜¯æ ¹æ®propertiesæ–‡ä»¶çš„é…ç½®ï¼Œç”Ÿæˆtranslationä»£ç ï¼Œå¦‚translation.goï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Code generated by &quot;i18ngenerator&quot;; DO NOT EDIT.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> translation</span><br><span class="line"></span><br><span class="line"><span class="comment">// Translations</span></span><br><span class="line"><span class="keyword">var</span> Translations <span class="keyword">map</span>[<span class="type">string</span>][][]<span class="type">string</span> = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>][][]<span class="type">string</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    Translations[<span class="string">&quot;en-US&quot;</span>] = [][]<span class="type">string</span>&#123;</span><br><span class="line">       &#123;</span><br><span class="line">          <span class="string">&quot;100001&quot;</span>,</span><br><span class="line">          <span class="string">&quot;input param [&#123;0&#125;] invitated&quot;</span>,</span><br><span class="line">       &#125;,</span><br><span class="line">       &#123;</span><br><span class="line">          <span class="string">&quot;input.desc.label&quot;</span>,</span><br><span class="line">          <span class="string">&quot;desc&quot;</span>,</span><br><span class="line">       &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    Translations[<span class="string">&quot;zh-CN&quot;</span>] = [][]<span class="type">string</span>&#123;</span><br><span class="line">       &#123;</span><br><span class="line">          <span class="string">&quot;100001&quot;</span>,</span><br><span class="line">          <span class="string">&quot;è¾“å…¥å‚æ•°[&#123;0&#125;]éæ³•&quot;</span>,</span><br><span class="line">       &#125;,</span><br><span class="line">       &#123;</span><br><span class="line">          <span class="string">&quot;input.desc.label&quot;</span>,</span><br><span class="line">          <span class="string">&quot;æè¿°&quot;</span>,</span><br><span class="line">       &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–‡ä»¶æ˜¯ç”±i18ngeneratorè‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä¸è¦è‡ªå·±æ”¹ã€‚<br>mainå‡½æ•°å†…ï¼Œå®ç°äº†ä¸€ä¸ªå°çš„è¾“å‡ºåŠŸèƒ½ï¼Œç®€å•çœ‹ä¸‹æºç ï¼Œç„¶åå»è¿›è¡Œæµ‹è¯•ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">    <span class="string">&quot;runtime&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;github.com/ci-plugins/golang-plugin-sdk/api&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/ci-plugins/golang-plugin-sdk/log&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/ci-plugins/plugin-demo-golang/translation&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//go:generate i18ngenerator i18n ./translation/translation.go</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> greetingParam <span class="keyword">struct</span> &#123;</span><br><span class="line">    UserName <span class="type">string</span> <span class="string">`json:&quot;userName&quot;`</span></span><br><span class="line">    Greeting <span class="type">string</span> <span class="string">`json:&quot;greeting&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *greetingParam)</span></span> String() <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;userName: %v, greeting: %v&quot;</span>, a.UserName, a.Greeting)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    runtime.GOMAXPROCS(<span class="number">4</span>)</span><br><span class="line">    log.Info(<span class="string">&quot;atom-demo-glang starts&quot;</span>)</span><br><span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">       <span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">          log.Error(<span class="string">&quot;panic: &quot;</span>, err)</span><br><span class="line">          api.FinishBuild(api.StatusError, <span class="string">&quot;panic occurs&quot;</span>)</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    api.InitI18n(translation.Translations, api.GetRuntimeLanguage())</span><br><span class="line">    msg, err := api.Localize(<span class="string">&quot;input.desc.label&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">       log.Error(err)</span><br><span class="line">    &#125;</span><br><span class="line">    log.Info(msg)</span><br><span class="line"></span><br><span class="line">    helloBuild()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">helloBuild</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// è·å–å•ä¸ªè¾“å…¥å‚æ•°</span></span><br><span class="line">    userName := api.GetInputParam(<span class="string">&quot;userName&quot;</span>)</span><br><span class="line">    log.Info(<span class="string">&quot;userName: &quot;</span>, userName)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰“å±</span></span><br><span class="line">    log.Info(<span class="string">&quot;\nBuildInfo:&quot;</span>)</span><br><span class="line">    log.Info(<span class="string">&quot;Project Name:     &quot;</span>, api.GetProjectDisplayName())</span><br><span class="line">    log.Info(<span class="string">&quot;Pipeline Id:      &quot;</span>, api.GetPipelineId())</span><br><span class="line">    log.Info(<span class="string">&quot;Pipeline Name:    &quot;</span>, api.GetPipelineName())</span><br><span class="line">    log.Info(<span class="string">&quot;Pipeline Version: &quot;</span>, api.GetPipelineVersion())</span><br><span class="line">    log.Info(<span class="string">&quot;Build Id:         &quot;</span>, api.GetPipelineBuildId())</span><br><span class="line">    log.Info(<span class="string">&quot;Build Num:        &quot;</span>, api.GetPipelineBuildNumber())</span><br><span class="line">    log.Info(<span class="string">&quot;Start Type:       &quot;</span>, api.GetPipelineStartType())</span><br><span class="line">    log.Info(<span class="string">&quot;Start UserId:     &quot;</span>, api.GetPipelineStartUserId())</span><br><span class="line">    log.Info(<span class="string">&quot;Start UserName:   &quot;</span>, api.GetPipelineStartUserName())</span><br><span class="line">    log.Info(<span class="string">&quot;Start Time:       &quot;</span>, api.GetPipelineStartTimeMills())</span><br><span class="line">    log.Info(<span class="string">&quot;Workspace:        &quot;</span>, api.GetWorkspace())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å…¥å‚æ•°è§£æåˆ°å¯¹è±¡</span></span><br><span class="line">    paramData := <span class="built_in">new</span>(greetingParam)</span><br><span class="line">    api.LoadInputParam(paramData)</span><br><span class="line">    log.Info(fmt.Sprintf(<span class="string">&quot;\n%vï¼Œ%v\n&quot;</span>, paramData.Greeting, paramData.UserName))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">    log.Info(<span class="string">&quot;start build&quot;</span>)</span><br><span class="line">    build()</span><br><span class="line">    time.Sleep(<span class="number">2</span> * time.Second)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡º</span></span><br><span class="line">    <span class="comment">// å­—ç¬¦ä¸²è¾“å‡º</span></span><br><span class="line">    strData := api.NewStringData(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">    api.AddOutputData(<span class="string">&quot;strData_01&quot;</span>, strData)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–‡ä»¶å½’æ¡£è¾“å‡º</span></span><br><span class="line">    artifactData := api.NewArtifactData()</span><br><span class="line">    artifactData.AddArtifact(<span class="string">&quot;result.dat&quot;</span>)</span><br><span class="line">    api.AddOutputData(<span class="string">&quot;artifactData_02&quot;</span>, artifactData)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠ¥å‘Šè¾“å‡º</span></span><br><span class="line">    reportData := api.NewReportData(<span class="string">&quot;label_01&quot;</span>, api.GetWorkspace()+<span class="string">&quot;/report&quot;</span>, <span class="string">&quot;report.htm&quot;</span>)</span><br><span class="line">    api.AddOutputData(<span class="string">&quot;report_01&quot;</span>, reportData)</span><br><span class="line"></span><br><span class="line">    api.WriteOutput()</span><br><span class="line">    log.Info(<span class="string">&quot;build done&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">build</span><span class="params">()</span></span> &#123;</span><br><span class="line">    log.Info(<span class="string">&quot;write result.dat&quot;</span>)</span><br><span class="line">    ioutil.WriteFile(api.GetWorkspace()+<span class="string">&quot;/result.dat&quot;</span>, []<span class="type">byte</span>(<span class="string">&quot;content&quot;</span>), <span class="number">0644</span>)</span><br><span class="line">    log.Info(<span class="string">&quot;write report.htm&quot;</span>)</span><br><span class="line">    os.Mkdir(api.GetWorkspace()+<span class="string">&quot;/report&quot;</span>, os.ModePerm)</span><br><span class="line">    ioutil.WriteFile(api.GetWorkspace()+<span class="string">&quot;/report/report.htm&quot;</span>, []<span class="type">byte</span>(<span class="string">&quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;Report&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;H1&gt;This is a Report&lt;/H1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>), <span class="number">0644</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨æ ¹ç›®å½•ä¸‹å·²ç»ç»™æˆ‘ä»¬é¢„è®¾äº†ä¸€ä¸ªtask.jsonæ–‡ä»¶ï¼Œåé¢å¯ä»¥ç®€å•ä¿®æ”¹ä¸‹è¿™ä¸ªæ–‡ä»¶æ¥å®ç°æµ‹è¯•ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;atomCode&quot;</span>: <span class="string">&quot;goDemo&quot;</span>,</span><br><span class="line">  <span class="string">&quot;execution&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;language&quot;</span>: <span class="string">&quot;golang&quot;</span>,</span><br><span class="line">    <span class="string">&quot;packagePath&quot;</span>: <span class="string">&quot;goDemo&quot;</span>,</span><br><span class="line">    <span class="string">&quot;demands&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;chmod +x goDemo&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;target&quot;</span>: <span class="string">&quot;./goDemo&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;input&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;greeting&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;label&quot;</span>: <span class="string">&quot;æ¬¢è¿è¯&quot;</span>,</span><br><span class="line">      <span class="string">&quot;default&quot;</span>: <span class="string">&quot;Glad to see you&quot;</span>,</span><br><span class="line">      <span class="string">&quot;placeholder&quot;</span>: <span class="string">&quot;æ¬¢è¿è¯&quot;</span>,</span><br><span class="line">      <span class="string">&quot;type&quot;</span>: <span class="string">&quot;vuex-input&quot;</span>,</span><br><span class="line">      <span class="string">&quot;desc&quot;</span>: <span class="string">&quot;æ¬¢è¿è¯&quot;</span>,</span><br><span class="line">      <span class="string">&quot;required&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;disabled&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;hidden&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;isSensitive&quot;</span>: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;userName&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;label&quot;</span>: <span class="string">&quot;å§“å&quot;</span>,</span><br><span class="line">      <span class="string">&quot;default&quot;</span>: <span class="string">&quot;Mr. Huang&quot;</span>,</span><br><span class="line">      <span class="string">&quot;placeholder&quot;</span>: <span class="string">&quot;å§“å&quot;</span>,</span><br><span class="line">      <span class="string">&quot;type&quot;</span>: <span class="string">&quot;vuex-input&quot;</span>,</span><br><span class="line">      <span class="string">&quot;desc&quot;</span>: <span class="string">&quot;å§“å&quot;</span>,</span><br><span class="line">      <span class="string">&quot;required&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;disabled&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;hidden&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;isSensitive&quot;</span>: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;output&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;strData_01&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;description&quot;</span>: <span class="string">&quot;æµ‹è¯•&quot;</span>,</span><br><span class="line">      <span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">      <span class="string">&quot;isSensitive&quot;</span>: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="å¦‚ä½•æ‰“åŒ…å‘å¸ƒ"><a href="#å¦‚ä½•æ‰“åŒ…å‘å¸ƒ" class="headerlink" title="å¦‚ä½•æ‰“åŒ…å‘å¸ƒ"></a>å¦‚ä½•æ‰“åŒ…å‘å¸ƒ</h2><ol>
<li>è¿›å…¥æ’ä»¶ä»£ç å·¥ç¨‹ç›®å½•ä¸‹</li>
<li>æ‰“åŒ…</li>
</ol>
<ul>
<li>å¦‚æœæŒ‰ç…§æ­£å¸¸çš„demoçš„ç›®å½•ç»“æ„æ˜¯éœ€è¦è¿›å…¥cmd&#x2F;applicationå†…æ‰§è¡Œbuildå‘½ä»¤ï¼Œå› ä¸ºmainåœ¨æ­¤</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd cmd/application</span><br><span class="line">GO111MODULE=on GOOS=linux GOARCH=amd64 go build -o bin/$&#123;executable&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>è¿™æ¬¡ç”¨çš„demoåˆ™ç›´æ¥åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œbuildå‘½ä»¤ï¼Œå› ä¸ºmainåœ¨æ ¹ç›®å½•ä¸‹</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">GO111MODULE=on GOOS=linux GOARCH=amd64 go build -o bin/$&#123;executable&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œgo build -o bin&#x2F;${executable}ä¼šåœ¨binç›®å½•ä¸‹ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ–‡ä»¶åæ˜¯${executable}ï¼Œå³é¡¹ç›®åã€‚<br>ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªåå­—ï¼Œå¦‚<code>GO111MODULE=on GOOS=linux GOARCH=amd64 go build -o bin/kingtest</code></p>
<ol>
<li>åœ¨ä»»æ„ä½ç½®æ–°å»ºæ–‡ä»¶å¤¹ï¼Œå‘½åç¤ºä¾‹ï¼šrelease_pkg &#x3D; &lt;ä½ çš„æ’ä»¶æ ‡è¯†&gt;_release</li>
<li>å°†æ­¥éª¤ 2 ç”Ÿäº§çš„æ‰§è¡ŒåŒ…æ‹·è´åˆ° ä¸‹</li>
<li>æ·»åŠ  task.json æ–‡ä»¶åˆ° ä¸‹ task.json è§ç¤ºä¾‹ï¼ŒæŒ‰ç…§æ’ä»¶åŠŸèƒ½é…ç½®ã€‚</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir kingtest_release</span><br><span class="line">cp bin/kingtest kingtest_release/kingtest</span><br><span class="line">touch kingtest_release/task.json</span><br></pre></td></tr></table></figure>

<ul>
<li>æ’ä»¶é…ç½®è§„èŒƒ</li>
<li>task.json ç¤ºä¾‹ï¼š</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;atomCode&quot;: &quot;king-test&quot;,                  # atomCode è¦ä¸å·¥ä½œå°å½•å…¥çš„ä¸€è‡´</span><br><span class="line">  &quot;execution&quot;: &#123;</span><br><span class="line">    &quot;language&quot;: &quot;golang&quot;,</span><br><span class="line">    &quot;packagePath&quot;: &quot;kingtest&quot;,              # å‘å¸ƒåŒ…ä¸­æ’ä»¶å®‰è£…åŒ…çš„ç›¸å¯¹è·¯å¾„</span><br><span class="line">    &quot;demands&quot;: [</span><br><span class="line">      &quot;echo start run chmod +x kingtest&quot;,   # æ’ä»¶å¯åŠ¨å‰éœ€è¦æ‰§è¡Œçš„å®‰è£…å‘½ä»¤ï¼Œé¡ºåºæ‰§è¡Œ</span><br><span class="line">      &quot;chmod +x kingtest&quot;,                  # æ’ä»¶å¯åŠ¨å‰éœ€è¦æ‰§è¡Œçš„å®‰è£…å‘½ä»¤ï¼Œé¡ºåºæ‰§è¡Œ</span><br><span class="line">      &quot;echo stop run chmod +x kingtest&quot;,    # æ’ä»¶å¯åŠ¨å‰éœ€è¦æ‰§è¡Œçš„å®‰è£…å‘½ä»¤ï¼Œé¡ºåºæ‰§è¡Œ</span><br><span class="line">    ],</span><br><span class="line">    &quot;target&quot;: &quot;./kingtest&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;input&quot;: &#123;</span><br><span class="line">    &quot;greeting&quot;: &#123;</span><br><span class="line">      &quot;label&quot;: &quot;æ¬¢è¿è¯&quot;,</span><br><span class="line">      &quot;default&quot;: &quot;Glad to see you&quot;,</span><br><span class="line">      &quot;placeholder&quot;: &quot;æ¬¢è¿è¯&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;vuex-input&quot;,</span><br><span class="line">      &quot;desc&quot;: &quot;æ¬¢è¿è¯&quot;,</span><br><span class="line">      &quot;required&quot;: true,</span><br><span class="line">      &quot;disabled&quot;: false,</span><br><span class="line">      &quot;hidden&quot;: false,</span><br><span class="line">      &quot;isSensitive&quot;: false</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;userName&quot;: &#123;</span><br><span class="line">      &quot;label&quot;: &quot;å§“å&quot;,</span><br><span class="line">      &quot;default&quot;: &quot;Mr. Huang&quot;,</span><br><span class="line">      &quot;placeholder&quot;: &quot;å§“å&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;vuex-input&quot;,</span><br><span class="line">      &quot;desc&quot;: &quot;å§“å&quot;,</span><br><span class="line">      &quot;required&quot;: true,</span><br><span class="line">      &quot;disabled&quot;: false,</span><br><span class="line">      &quot;hidden&quot;: false,</span><br><span class="line">      &quot;isSensitive&quot;: false</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;output&quot;: &#123;</span><br><span class="line">    &quot;strData_01&quot;: &#123;</span><br><span class="line">      &quot;description&quot;: &quot;æµ‹è¯•&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;string&quot;,</span><br><span class="line">      &quot;isSensitive&quot;: false</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>åœ¨ ç›®å½•ä¸‹ï¼ŒæŠŠæ‰€æœ‰æ–‡ä»¶æ‰“æˆ zip åŒ…å³å¯</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd kingtest_release &amp;&amp; zip kingtest_release.zip kingtest task.json</span><br></pre></td></tr></table></figure>

<p>zipåŒ…ç»“æ„ç¤ºä¾‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">|- kingtest_release.zip         # å‘å¸ƒåŒ…</span><br><span class="line">   |- kingtest                  # æ’ä»¶æ‰§è¡ŒåŒ…</span><br><span class="line">   |- task.json                 # æ’ä»¶é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p>æ‰“åŒ…å®Œæˆåï¼Œåœ¨æ’ä»¶å·¥ä½œå°æå•å‘å¸ƒï¼Œå³å¯æµ‹è¯•æˆ–å‘å¸ƒæ’ä»¶</p>
<h1 id="ä¸Šä¼ ä¸€ä¸ªæµæ°´çº¿æ’ä»¶"><a href="#ä¸Šä¼ ä¸€ä¸ªæµæ°´çº¿æ’ä»¶" class="headerlink" title="ä¸Šä¼ ä¸€ä¸ªæµæ°´çº¿æ’ä»¶"></a>ä¸Šä¼ ä¸€ä¸ªæµæ°´çº¿æ’ä»¶</h1><blockquote>
<p>å¼€å‘å¥½æ’ä»¶ä¹‹åï¼Œé€šè¿‡ç ”å‘å•†åº—å·¥ä½œå°ï¼Œå°†æ’ä»¶å‘å¸ƒåˆ°ç ”å‘å•†åº—ï¼Œæä¾›ç»™ç”¨æˆ·æ·»åŠ åˆ°æµæ°´çº¿ä¸­ä½¿ç”¨ã€‚</p>
</blockquote>
<h2 id="å…¥å£"><a href="#å…¥å£" class="headerlink" title="å…¥å£"></a>å…¥å£</h2><p>åœ¨å·¥ä½œå°åˆ—è¡¨ï¼Œç‚¹å‡»å¦‚ä¸‹å…¥å£å‘èµ·å‘å¸ƒæµç¨‹ï¼š<br><img src="/img_3.png" alt="img_3.png"></p>
<p>é¦–æ¬¡å‘å¸ƒæ—¶ï¼Œå…¥å£åä¸ºä¸Šæ¶<br>åç»­æ›´æ–°ç‰ˆæœ¬æ—¶ï¼Œå…¥å£åä¸ºå‡çº§<br>æˆ–è€…åœ¨æ’ä»¶å‘å¸ƒç®¡ç†-&gt;ç‰ˆæœ¬ç®¡ç†ç•Œé¢å‘èµ·å‘å¸ƒæµç¨‹ï¼š<br><img src="/img_4.png" alt="img_4.png"></p>
<h2 id="å¡«å†™æ’ä»¶ç›¸å…³ä¿¡æ¯-ä¸Šä¼ æ’ä»¶å‘å¸ƒåŒ…"><a href="#å¡«å†™æ’ä»¶ç›¸å…³ä¿¡æ¯-ä¸Šä¼ æ’ä»¶å‘å¸ƒåŒ…" class="headerlink" title="å¡«å†™æ’ä»¶ç›¸å…³ä¿¡æ¯&#x2F;ä¸Šä¼ æ’ä»¶å‘å¸ƒåŒ…"></a>å¡«å†™æ’ä»¶ç›¸å…³ä¿¡æ¯&#x2F;ä¸Šä¼ æ’ä»¶å‘å¸ƒåŒ…</h2><p>ä¸Šæ¶&#x2F;å‡çº§æ’ä»¶æ—¶ï¼Œå¯ä»¥ä¿®æ”¹æ’ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="/img_5.png" alt="img_5.png"></p>
<ol>
<li>é€‚ç”¨ Job ç±»å‹ï¼š</li>
</ol>
<ul>
<li>å’Œæµæ°´çº¿ Job ç±»å‹å¯¹åº”ï¼Œè¯·æŒ‰ç…§æ’ä»¶å®é™…é€‚ç”¨æƒ…å†µé€‰æ‹©</li>
<li>è‹¥é€‰é”™ï¼Œéœ€æ–°å¢ç‰ˆæœ¬ä¿®æ”¹</li>
</ul>
<ol start="2">
<li>å‘å¸ƒåŒ…ï¼š</li>
</ol>
<ul>
<li>task.json ä¸­çš„ atomCode éœ€å’Œ æ–°å¢æ’ä»¶æ—¶å¡«å†™çš„æ ‡è¯†ä¸€è‡´ï¼Œå¦åˆ™ä¸Šä¼ ä¼šå¤±è´¥</li>
</ul>
<h2 id="æµ‹è¯•-å‘å¸ƒæ’ä»¶"><a href="#æµ‹è¯•-å‘å¸ƒæ’ä»¶" class="headerlink" title="æµ‹è¯•&#x2F;å‘å¸ƒæ’ä»¶"></a>æµ‹è¯•&#x2F;å‘å¸ƒæ’ä»¶</h2><blockquote>
<p>å¡«å†™å¥½ä¿¡æ¯ï¼Œæäº¤åï¼Œè¿›å…¥å‘å¸ƒæµç¨‹ï¼Œå¯ä»¥æµ‹è¯•-&gt;é‡æ–°ä¼ åŒ…-&gt;æµ‹è¯•ï¼Œç›´è‡³æ’ä»¶æ»¡è¶³é¢„æœŸåï¼Œæ‰‹åŠ¨ç»§ç»­æµç¨‹å°†æ’ä»¶å‘å¸ƒåˆ°ç ”å‘å•†åº—</p>
</blockquote>
<p><img src="/img_6.png" alt="img_6.png"></p>
<ol>
<li>æµ‹è¯•ï¼šç‚¹å‡»åè·³è½¬åˆ°æ’ä»¶è°ƒè¯•é¡¹ç›®çš„æµæ°´çº¿æœåŠ¡ä¸‹ï¼Œå¯ä»¥å°†å½“å‰æ’ä»¶æ·»åŠ åˆ°æµæ°´çº¿ï¼ŒéªŒè¯ UIã€åŠŸèƒ½æ˜¯å¦æ»¡è¶³é¢„æœŸ</li>
<li>é‡æ–°ä¼ åŒ…ï¼šå½“æµ‹è¯•å‘ç°é—®é¢˜ï¼Œä¿®å¤åï¼Œé‡æ–°ä¸Šä¼ å‘å¸ƒåŒ…ï¼Œå†æ¬¡è¿›è¡Œæµ‹è¯•</li>
<li>ç»§ç»­ï¼šæµ‹è¯• OKï¼Œæ»¡è¶³é¢„æœŸåï¼Œç¡®è®¤æäº¤å‘å¸ƒ</li>
<li>å–æ¶ˆå‘å¸ƒï¼šå‘å¸ƒè¿‡ç¨‹ä¸­ï¼Œéšæ—¶å¯ä»¥ç»ˆæ­¢å‘å¸ƒ</li>
</ol>
<h2 id="é‡è§çš„å‡ ä¸ªé”™è¯¯"><a href="#é‡è§çš„å‡ ä¸ªé”™è¯¯" class="headerlink" title="é‡è§çš„å‡ ä¸ªé”™è¯¯"></a>é‡è§çš„å‡ ä¸ªé”™è¯¯</h2><h3 id="æ— æƒé™æ‰§è¡Œ"><a href="#æ— æƒé™æ‰§è¡Œ" class="headerlink" title="æ— æƒé™æ‰§è¡Œ"></a>æ— æƒé™æ‰§è¡Œ</h3><p>åœ¨æµ‹è¯•ä¸­é‡è§ä¸€ä¸ªé—®é¢˜ï¼šæ— æƒé™æ‰§è¡Œ<br><img src="/img_7.png" alt="img_7.png"></p>
<p>åœ¨<code>execution-&gt;demands</code>å¢åŠ ä¸€ä¸ªå‘½ä»¤<code>chmod +x kingtest</code>å³å¯è§£å†³</p>
<h3 id="å‘å¸ƒè¿›åº¦é‡Œé‡æ–°ä¼ åŒ…æŒç»­æŠ¥é”™task-jsonæ ¼å¼é”™è¯¯"><a href="#å‘å¸ƒè¿›åº¦é‡Œé‡æ–°ä¼ åŒ…æŒç»­æŠ¥é”™task-jsonæ ¼å¼é”™è¯¯" class="headerlink" title="å‘å¸ƒè¿›åº¦é‡Œé‡æ–°ä¼ åŒ…æŒç»­æŠ¥é”™task.jsonæ ¼å¼é”™è¯¯"></a>å‘å¸ƒè¿›åº¦é‡Œé‡æ–°ä¼ åŒ…æŒç»­æŠ¥é”™task.jsonæ ¼å¼é”™è¯¯</h3><p>è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œåœ¨å‘å¸ƒè¿›åº¦é‡Œé‡æ–°ä¼ åŒ…æ—¶ï¼Œä¸€ç›´æŠ¥é”™task.jsonæ ¼å¼é”™è¯¯ï¼Œä½†å®é™…æ ¼å¼æ˜¯å¯¹çš„ï¼<br>è§¦å‘çš„åŸå› æš‚ä¸çŸ¥é“ï¼Œä½†æ˜¯ç¡®å®æ˜¯ä¸€ä¸ªéšè—çš„bugã€‚<br><img src="/img_8.png" alt="img_8.png"></p>
<p>ç›´æ¥ç‚¹å‡»ç»§ç»­ï¼Œç„¶åèµ°å‡çº§æ’ä»¶çš„æ–¹å¼å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p>
<h3 id="cannot-execute-binary-file-Exec-format-error"><a href="#cannot-execute-binary-file-Exec-format-error" class="headerlink" title="cannot execute binary file: Exec format error"></a>cannot execute binary file: Exec format error</h3><p>è¿™é‡Œçš„é—®é¢˜æ˜¯æˆ‘é€ æˆçš„ï¼Œæœ€åˆæˆ‘åœ¨macç¯å¢ƒä¸‹ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå‘½ä»¤æ˜¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">macä¸‹æ‰§è¡Œ</span></span><br><span class="line">go build -o bin/kingtest</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æ’ä»¶é‡Œé€‰æ‹©çš„ç¼–è¯‘ç¯å¢ƒæ˜¯linuxã€‚<br><img src="/img_9.png" alt="img_9.png"></p>
<p>è§£å†³æ–¹å¼ï¼šè®©æ’ä»¶é€‰æ‹©çš„ç¼–è¯‘ç¯å¢ƒå’Œå¯æ‰§è¡Œæ–‡ä»¶çš„å¹³å°ç»Ÿä¸€ã€‚<br>æˆ‘è¿™é‡Œé€‰æ‹©é‡æ–°ç¼–è¯‘ä¸‹å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‡‡ç”¨åœ¨macå¹³å°äº¤å‰ç¼–è¯‘linuxå¹³å°å¯æ‰§è¡Œæ–‡ä»¶çš„æ–¹å¼ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">GO111MODULE=on GOOS=linux GOARCH=amd64 go build -o bin/kingtest</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªæ’ä»¶ï¼Œç¼–è¯‘ç¯å¢ƒé€‰æ‹©macã€‚</p>
<h2 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h2><p>æµæ°´çº¿ç»“æœï¼š<br><img src="/img_10.png" alt="img_10.png"></p>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[Plugin info]</span><br><span class="line">=====================================================================</span><br><span class="line">Task           : king-test</span><br><span class="line">Description    : bkæ’ä»¶æµ‹è¯•</span><br><span class="line">Version        : 1.0.3</span><br><span class="line">Author         : huari</span><br><span class="line">Help           : More Information</span><br><span class="line">=====================================================================</span><br><span class="line">-----</span><br><span class="line">[Input]</span><br><span class="line">input(normal): (æ¬¢è¿è¯)greeting=Glad to see you</span><br><span class="line">input(normal): (å§“å)userName=Mr. Huang</span><br><span class="line">-----</span><br><span class="line">[Install plugin]</span><br><span class="line">-----</span><br><span class="line">start run chmod +x kingtest</span><br><span class="line">stop run chmod +x kingtest</span><br><span class="line">atom-demo-glang starts</span><br><span class="line">æè¿°</span><br><span class="line">userName:  Mr. Huang</span><br><span class="line"></span><br><span class="line">BuildInfo:</span><br><span class="line">Project Name:      GOPS</span><br><span class="line">Pipeline Id:       p-8967ed52b08847c8a5b0140937db0975</span><br><span class="line">Pipeline Name:     king-test</span><br><span class="line">Pipeline Version:  11</span><br><span class="line">Build Id:          b-78947b5c39f34b32bbafb803042d1e22</span><br><span class="line">Build Num:         15</span><br><span class="line">Start Type:        MANUAL</span><br><span class="line">Start UserId:      huari</span><br><span class="line">Start UserName:    huari</span><br><span class="line">Start Time:        1733298107286</span><br><span class="line">Workspace:         /data/devops/workspace</span><br><span class="line"></span><br><span class="line">Glad to see youï¼ŒMr. Huang</span><br><span class="line">start build</span><br><span class="line">write result.dat</span><br><span class="line">write report.htm</span><br><span class="line">build done</span><br><span class="line">[Output]</span><br><span class="line">1 file match: </span><br><span class="line">  /data/devops/workspace/result.dat</span><br><span class="line">prepare to upload 7 B</span><br><span class="line">1/1 file(s) finished</span><br><span class="line">output(except): artifactData_02=result.dat</span><br><span class="line">å…¥å£æ–‡ä»¶æ£€æµ‹å®Œæˆ</span><br><span class="line">ä¸Šä¼ è‡ªå®šä¹‰äº§å‡ºç‰©æˆåŠŸï¼Œå…±äº§ç”Ÿäº†1ä¸ªæ–‡ä»¶</span><br><span class="line">output(except): report_01=report.htm</span><br><span class="line">output(normal): strData_01=test</span><br><span class="line">-----</span><br><span class="line"></span><br></pre></td></tr></table></figure>






]]></content>
  </entry>
</search>
